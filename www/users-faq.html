<!doctype html PUBLIC "-//W3C//DTD HTML 4.0//EN">

<html lang="en">
  <head>
    <meta lang="en" http-equiv="content-type" content="text/html; charset=ISO-8859-1">
    <title>OO.o frequently asked user questions</title>
    <link rel="icon" href="http://www.ximian.com/favicon.png" type="image/png">
  </head>

  <body>
      <h2>OO.o frequently asked user questions</h2>

      <h3>How do I turn off the splash screen ?</h3>
      <p>
        Edit your <code>/usr/lib/ooo-1.0.3/program/sofficerc</code>
	(or equivalent), and set Logo=0 instead of 1.
      </p>

      <h3>What environment variables can I tweak when things don't work</h3>
      <p>
        For those unfamiliar with Unix; these variables can be set before
	running OO.o by doing <code>export <i>variable</i>=<i>value</i></code>
	on the console. Make sure there is no existing OO.o running when
	you re-run OO.o though.
      </p>
      <table summary="Variables and their definitions">
        <tr>
		<th>variable</th><th>values</th><th>behavior</th>
	</tr>
	<tr>
		<td>AUDIODEV</td><td>eg. /dev/audio3</td>
		<td>
		   This allows a non-default audio device to be assigned
		   for use in OO.o. Particularly useful in thin-client
		   situations.
		</td>
	</tr>
	<tr>
		<td>DISPLAY</td><td>eg. :0.0</td>
		<td>
		  A very standard X environment variable to instruct the
		  application to start on a remote / different display.
		</td>
	</tr>
	<tr>
		<td>GALLERY_ENABLE_ID_DIALOG</td><td><i>set</i></td>
		<td>
		   Enable a right click menu allowing the icons' ID to be
		   set, assuming you have write access to the gallery theme.
		</td>
	</tr>
	<tr>
		<td>GALLERY_SHOW_HIDDEN_THEMES</td><td><i>set</i></td>
		<td>
		   Allows the gallery to show the private themes used for
		   HtmlExportButtons and various special powerpoint shapes.
		</td>
	</tr>
	<tr>
		<td>GALLERY_SHOW_PRIVATE_TITLE</td><td><i>set</i></td>
		<td>
		   Adds a right click -&gt; 'Title' option for the gallery
		   icons; NB. these must be writable by the user.
		</td>
	</tr>
	<tr>
		<td>SAL_ANTIALIAS_DISABLE</td><td><i>set</i></td>
		<td>
		   This disabled anti-aliased font rendering; useful
		   for debugging.
		</td>
	</tr>
	<tr>
		<td>SAL_DO_NOT_USE_INVERT50</td><td>true</td>
		<td>
		  If you are running XFree86 &lt; 4.2 and have an S3 Savage
		  chip, you must use this, otherwise OOo will not work
		  and the Xserver will eventually hang / lock the machine.
		</td>
	</tr>
	<tr>
		<td>SAL_ENABLE_GLX_XFREE4</td><td><i>set</i></td>
		<td>
		   If set, this enables the use of XFree4.0's GLX
		   module which is considered to be badly buggy and is
		   disabled by default; apparently this is mostly
		   Matrox related however.
		</td>
	</tr>
	<tr>
		<td>SAL_HIGHPRIORITY_REPAINT</td><td><i>any</i></td>
		<td>
		  Apparently useful for taking screenshots.
		</td>
	</tr>
	<tr>
		<td>SAL_IGNOREXERRORS</td><td><i>any</i></td>
		<td>
		  Instructs the GUI to ignore any errors from the X
		  server.
		</td>
	</tr>
	<tr>
		<td>SAL_NOOPENGL</td><td>true</td>
		<td>
		   If set to 'true' this completely disables probing for
		   and/or use of OpenGL within OO.o. This can be important
		   for licensed and/or buggy implementations.
		</td>
	</tr>
	<tr>
		<td>SAL_SYNCHRONIZE</td><td><i>set</i></td>
		<td>
		  This forces the X server to report errors
		  synchronously, which means that the application runs
		  far slower, but pinpointing an error in the code is
		  possible.
		</td>
	</tr>
	<tr>
		<td>SAL_VISUAL</td><td>eg. 24 <i>bitdepth</i></td>
		<td>
		  Overrides the choice of visual algorithm to force
		  a certain choice of bitdepth from the list of
		  supported visuals.
		</td>
	</tr>
      </table>
      <p>
        This list is not exhaustive - there are many, many similar tweaks
	built into OO.o; Search for 'getenv' in
	<a href="http://ooo.ximian.com/lxr">LXR</a> for a more exhaustive
	result.
      </p>

      <h3>X server crash with Matrox cards</h3>

      <p>
        If your X server is using the mga driver, you may find your X server
	crashes.  If so, add this option to the mga 'Device' section of
	/etc/X11/XFree86Config[-4]:
      </p>
	<pre>Option "XaaNoScreenToScreenColorExpandFill"</pre>

      <h3>How do I print lots of files to PDF ?</h3>

	  <p>
        Even when OpenOffice Ximian Edition can export directly to a PDF file and
		it does not use psprint.conf script anymore, you can still add a PDF
		printer using CUPS.<br/>
		So just follow the next few steps to add a PDF printer and OpenOffice will see it automatically.
		<ol type="1">
		 <li/>Get the <a href="http://www.geocrawler.com/archives/3/1837/2001/8/0/6356018/">pdf</a> script written by <a href="http://people.kde.org/michaelg.html">Michael Goffioul</a>, and save it into your /usr/lib/cups/backend directory
		 <li/>Apply a <b>chown root:root pdf && chmod a+rx pdf</b> command to set it executable as root.
		 <li/>Then download <a href="http://www.pentondigitalads.com/downloads/adist4.zip">distiller.ppd</a> to your /usr/share/cups/model/ directory.
		 <li/>Restart CUPS with a <b>/sbin/service cups restart</b> command (as superuser, you have CUPS installed right?)
		 <li/>Enter the CUPS web interface (<a href="http://localhost:631/">http://localhost:631</a>)
		 <li/>Select the "Do Administration Tasks" option (you'll be prompted for a password)
		 <li/>Click on "Add Printer" and enter a printer Name at least. Then click on continue.
		 <li/>On Device, select PDF Writing
		 <li/>The next step is to write a Device URI, here type: <b>pdf:/tmp</b> or whatever directory you want for the output file to be saved.
		 <li/>Then select the in Model/Driver select Adobe and click on continue.
		 <li/>Select Acrobat Distiller again.
		 <li/>And that's all you've got a brand new PDF printer, now go to OpenOffice and try to print something
		</ol>
	  </p>

	  <h3>OK, but I don't like the autogenerated filename, how can I change it?</h3>
	  <p>
		That annoying filename will prevent you for an overwriting. Anyway, I don't like it either, so go and change
		your pdf script, for something like this:<br/>
		<code>
		# generate output filename <br/>
		OUTPUTFILENAME=<br/>
		if [ "$3" = "" ]; then<br/>
        	OUTPUTFILENAME="$PDFDIR/MyPDFfile.pdf"<br/>
		else<br/>
				#OUTPUTFILENAME="$PDFDIR/${3//[^[:alnum:]]/_}.pdf"<br/>
        		OUTPUTFILENAME="$PDFDIR/My${3//[^[:alnum:]]/_}PDFfile.pdf"<br/>
		fi<br/>

		echo "Output file name: $OUTPUTFILENAME" > $LOGFILE<br/>
		</code>
		I keep it statically as $PDFDIR/MyPDFfile.pdf because of a PHP monitor,
		so everytime I send something to print this script returns a download box
		and then I can save it or print it directly to a non "virtual" printer.
	  </p>

  </body>
</html>
