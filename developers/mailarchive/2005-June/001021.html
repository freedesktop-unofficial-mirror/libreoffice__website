<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Open Office] m109 build failure with ooo-build HEAD and gcc4
   </TITLE>
   <LINK REL="Index" HREF="http://lists.ximian.com/pipermail/openoffice/2005-June/index.html" >
   <LINK REL="made" HREF="mailto:openoffice%40lists.ximian.com?Subject=%5BOpen%20Office%5D%20m109%20build%20failure%20with%20ooo-build%20HEAD%20and%20gcc4&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001023.html">
   <LINK REL="Next"  HREF="001022.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Open Office] m109 build failure with ooo-build HEAD and gcc4</H1>
    <B>Petr Mladek</B> 
    <A HREF="mailto:openoffice%40lists.ximian.com?Subject=%5BOpen%20Office%5D%20m109%20build%20failure%20with%20ooo-build%20HEAD%20and%20gcc4&In-Reply-To="
       TITLE="[Open Office] m109 build failure with ooo-build HEAD and gcc4">pmladek at suse.cz
       </A><BR>
    <I>Fri Jun 17 05:41:26 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001023.html">[Open Office] m108 build failure with Sun JDK 1.4.2
</A></li>
        <LI>Next message: <A HREF="001022.html">[Open Office] m109 build failure with ooo-build HEAD and gcc4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1021">[ date ]</a>
              <a href="thread.html#1021">[ thread ]</a>
              <a href="subject.html#1021">[ subject ]</a>
              <a href="author.html#1021">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I got the following build error with m109, ooo-build HEAD, and gcc4:

/usr/src/packages/BUILD/ooo-build-1.9.109/build/src680-m109/xmlhelp/util
------------------------------
Making: ../unxlngi6.pro/lib/libucpchelp1.so
/opt/icecream/bin/g++ -Wl,-z,combreloc -Wl,-z,defs -Wl,-rpath,'$ORIGIN' 
-shared -Wl,-O1 -Wl,--version-script ..
/unxlngi6.pro/misc/exports_ucpchelp1.map -L../unxlngi6.pro/lib -L../lib 
-L/usr/src/packages/BUILD/ooo-build-1.9
.109/build/src680-m109/solenv/unxlngi6/lib 
-L/usr/src/packages/BUILD/ooo-build-1.9.109/build/src680-m109/solver
/680/unxlngi6.pro/lib 
-L/usr/src/packages/BUILD/ooo-build-1.9.109/build/src680-m109/solenv/unxlngi6/lib 
-L/usr/
lib/jvm/java/lib -L/usr/lib/jvm/java/jre/lib/i386 
-L/usr/lib/jvm/java/jre/lib/i386/client -L/usr/lib/jvm/java/j
re/lib/i386/native_threads -L/usr/X11R6/lib 
-L/opt/mozilla/lib ../unxlngi6.pro/slo/ucpchelp1_version.o ../unxln
gi6.pro/slo/ucpchelp1_description.o 
-o ../unxlngi6.pro/lib/libucpchelp1.so ../unxlngi6.pro/slo/ConceptData.o
../unxlngi6.pro/slo/ContextTables.o ../unxlngi6.pro/slo/DocGenerator.o
../unxlngi6.pro/slo/Query.o ../unxlngi6.pro/slo/QueryProcessor.o
../unxlngi6.pro/slo/Search.o ../unxlngi6.pro/slo/XmlIndex.o 
../unxlngi6.pro/slo/Decompressor.o ../unxlngi6.pro/slo/IndexAccessor.o
../unxlngi6.pro/slo/Block.o ../unxlngi6.pro/slo/BlockManager.o
../unxlngi6.pro/slo/BtreeDict.o ../unxlngi6.pro/slo/Schema.o
../unxlngi6.pro/slo/services.o ../unxlngi6.pro/slo/provider.o
../unxlngi6.pro/slo/content.o ../unxlngi6.pro/slo/resultset.o
../unxlngi6.pro/slo/resultsetbase.o ../unxlngi6.pro/slo/resultsetforroot.o
../unxlngi6.pro/slo/resultsetforquery.o ../unxlngi6.pro/slo/contentcaps.o
../unxlngi6.pro/slo/urlparameter.o ../unxlngi6.pro/slo/inputstream.o
../unxlngi6.pro/slo/debughelper.o ../unxlngi6.pro/slo/databases.o
../unxlngi6.pro/slo/db.o ../unxlngi6.pro/slo/bufferedinputstream.o 
-luno_cppuhelpergcc3 -lu
no_cppu -luno_sal -lvos3gcc3 -lsablot -lexpat -lucbhelper3gcc3 -lsvt680li 
-ldb-4.2 -ldl -lpthread -lm -Wl,-Bdyn
amic -lstlport_gcc
../unxlngi6.pro/slo/databases.o: In function 
`chelp::Databases::getImagesZipFileURL()':
databases.cxx:(.text+0xa3d): undefined reference to 
`SvtMiscOptions::SvtMiscOptions()'
databases.cxx:(.text+0xa45): undefined reference to 
`SvtMiscOptions::GetCurrentSymbolsStyle() const'
databases.cxx:(.text+0xa50): undefined reference to 
`SvtMiscOptions::~SvtMiscOptions()'
databases.cxx:(.text+0xa73): undefined reference to 
`SvtMiscOptions::~SvtMiscOptions()'
databases.cxx:(.text+0xaa0): undefined reference to 
`SvtMiscOptions::SvtMiscOptions()'
databases.cxx:(.text+0xaac): undefined reference to 
`SvtMiscOptions::GetCurrentSymbolsStyleName() const'
databases.cxx:(.text+0xab9): undefined reference to 
`SvtMiscOptions::~SvtMiscOptions()'
databases.cxx:(.text+0xac9): undefined reference to 
`SvtMiscOptions::~SvtMiscOptions()'
collect2: ld returned 1 exit status
dmake:  Error code 1, while making '../unxlngi6.pro/lib/libucpchelp1.so'
'---* tg_merge.mk *---'

ERROR: Error 65280 occurred while 
making /usr/src/packages/BUILD/ooo-build-1.9.109/build/src680-m109/xmlhelp/ut
il

The problem is the visibility feature. The class SvtMiscOptions is defined the 
following way in svtools/inc/miscopt.hxx

--- cut ---
class SVL_DLLPUBLIC SvtMiscOptions
{
...
--- cut ---

If I understand it correctly, the symbols are visible just in libsvl but 
libucpchelp1.so is linked against libsvt. libsvt itself is linked against 
libsvl but this does not seems to be enough to make the symbols visible for 
libucpchelp1.so.

The build pass if I link rather against libsvl. The patch is:
--- xmlhelp/util/makefile.mk.old        2005-06-16 18:41:13.000000000 +0200 
+++ xmlhelp/util/makefile.mk    2005-06-17 11:22:04.000000000 +0200 
@@ -105,7 +105,7 @@ 
        $(SABLOT3RDLIB)          \ 
        $(EXPATASCII3RDLIB)      \ 
        $(UCBHELPERLIB)          \ 
-       $(SVTOOLLIB)             \ 
+       $(SVLLIB)             \ 
        $(BERKELEYLIB) 
 #      $(BERKELEYCPPLIB) 

But I am not sure about the fix. I don't know what's the difference between 
libsvl and libsvt and what library should be used here.

Well, the problem was added by the new Kendy's patch 
icons-switching-xmlhelp.diff. Kendy is not in the office today. So, we could 
wait for him until Monday.

But, maybe, you could help. Otherwise, you are informed about the problem at 
least now :-)

-- 
Best Regards,

Petr Mladek
software developer
---------------------------------------------------------------------  
SuSE CR, s.r.o.                             e-mail: <A HREF="http://lists.ximian.com/mailman/listinfo/openoffice">pmladek at suse.cz</A>
Drahobejlova 27                             tel:+420 296 542 373 
190 00 Praha 9                              fax:+420 296 542 374   
Czech Republic                              <A HREF="http://www.suse.cz/">http://www.suse.cz/</A>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001023.html">[Open Office] m108 build failure with Sun JDK 1.4.2
</A></li>
	<LI>Next message: <A HREF="001022.html">[Open Office] m109 build failure with ooo-build HEAD and gcc4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1021">[ date ]</a>
              <a href="thread.html#1021">[ thread ]</a>
              <a href="subject.html#1021">[ subject ]</a>
              <a href="author.html#1021">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.ximian.com/mailman/listinfo/openoffice">More information about the Openoffice
mailing list</a><br>
</body></html>
